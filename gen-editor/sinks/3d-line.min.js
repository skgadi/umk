function clearData(){fullData=[],reactTheChart()}function appendData(e){if(!fullData.length&&e.length){settings.noOfPlots=0;for(let t=0;t<e[0].v[0].r.length;t++)for(let l=0;l<e[0].v[0].r[0].length;l++)["","Img"].forEach(function(e){fullData.push({type:"scatter3d",name:e+"("+t+","+l+")",visible:!settings.showIm&&settings.noOfPlots%2?"legendonly":"true",mode:settings.mode,x:[],y:[],z:[],opacity:1,line:{width:settings.width,color:[],colorscale:settings.colorscale,reversescale:settings.reversescale}}),settings.noOfPlots++});for(let e=0;e<settings.noOfPlots;e++);}for(let t=0;t<e.length;t++){let l=0;for(let a=0;a<e[t].v[0].r.length;a++)for(let o=0;o<e[t].v[0].r[0].length;o++)fullData[l].x.push(Number(e[t].v[0].r[a][o])),fullData[l].y.push(Number(e[t].v[1].r[a][o])),fullData[l].z.push(Number(e[t].v[2].r[a][o])),fullData[l].line.color.push(Number(e[t].v[3].r[a][o])),l++,fullData[l].x.push(Number(e[t].v[0].i[a][o])),fullData[l].y.push(Number(e[t].v[1].i[a][o])),fullData[l].z.push(Number(e[t].v[2].i[a][o])),fullData[l].line.color.push(Number(e[t].v[3].i[a][o])),l++}fullData=fullData.slice(-settings.limitData),reactTheChart()}function updateConfiguration(){for(let e=0;e<fullData.length;e++){const t=fullData[e];t.mode=settings.mode,t.line.width=settings.width,t.visible=!settings.showIm&&e%2?"legendonly":"true",t.line.reversescale=settings.reversescale,t.line.colorscale=settings.colorscale}reactTheChart()}function reactTheChart(){Plotly.react("chart",fullData,settings.chartLayout)}function updateColors(){document.getElementsByTagName("html")[0].className=settings.mSettings.theme,settings.chartLayout.plot_bgcolor=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("background-color"),settings.chartLayout.paper_bgcolor=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("background-color"),settings.chartLayout.font.color=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("color"),["xaxis","yaxis","zaxis"].forEach(function(e){settings.chartLayout.scene[e].tickcolor=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("color"),settings.chartLayout.scene[e].gridcolor=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("border-color"),settings.chartLayout.scene[e].zerolinecolor=window.getComputedStyle(document.getElementById("css-ref-ele-0"),null).getPropertyValue("color")}),reactTheChart()}const settings={width:5,reversescale:!1,mode:"lines",showIm:!1,limitData:1e3,mSettings:{},colorscale:"jet",noOfPlots:1,chartLayout:{paper_bgcolor:"#ffffff00",plot_bgcolor:"#ffffff00",font:{color:"#000"},scene:{xaxis:{tickcolor:"#000",gridcolor:"#888",zerolinecolor:"#000"},yaxis:{tickcolor:"#000",gridcolor:"#888",zerolinecolor:"#000"},zaxis:{tickcolor:"#000",gridcolor:"#888",zerolinecolor:"#000"}},margin:{l:0,r:0,b:0,t:0},legend:{y:.5}},chartConfig:{displaylogo:!1,toImageButtonOptions:{filename:"umk_3D_line_chart"},responsive:!0}};let fullData=[];Plotly.newPlot("chart",fullData,settings.chartLayout,settings.chartConfig),onmessage=function(e){e.data.d&&appendData(e.data.d),e.data.r&&clearData(),e.data.c&&(settings.width=JSON.parse(e.data.c.Parameters.width.Value)[0][0],settings.reversescale=!!e.data.c.Parameters.reversescale.Value[0][0],settings.showIm=!!e.data.c.Parameters.showIm.Value[0][0],settings.mode=e.data.c.Parameters.mode.Value[0][0],settings.colorscale=e.data.c.Parameters.colorscale.Value[0][0],settings.limitData=JSON.parse(e.data.c.Parameters.limitData.Value)[0][0],updateConfiguration()),e.data.s&&(settings.mSettings=e.data.s,updateColors())};